Header
  + name := MAIN;
  
Private
  - values:ARRAY ℤ
  
  - valook: ARRAY STRING_ALIAS
  
  - operations:STRING_ALIAS := "---------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------\
  \--------------------------------------------------------------------------------------------------"
  
Public
  - main <-
  ( + intz:ℤ
    + a,b,c:ℤ
    + j:INTEGER
    + op:CHARACTER
    values := ARRAY ℤ .create_with_capacity 1024
    valook := ARRAY STRING_ALIAS .create_with_capacity 1024
    intz := 1
    values_add intz
    intz := 2
    values_add intz
    0.to (operations.upper) do { i:INTEGER
      a := values.at (values.upper - 1)
      b := values.at (values.upper)
      op := operations.at i
      (op = '+').if {
        values_add (a + b)
      }.elseif {op = '-'} then {
        values_add (a - b)
      } else {
        TEST.check FALSE
      }
      //("values.last= " + op.to_string + " " + valook.last).println
    }
    TEST.check (values.upper = valook.upper)
    /*
    "=============".println
    0.to (valook.upper) do { idx:INTEGER
      (idx.to_string + " " + (valook.at idx)).println
    }
    "=============".println
    */
    
    j := values.upper
    (operations.upper).downto 0 do { i:INTEGER
      c := values.at (values.upper)
      //("c=" + c.to_string).println
      TEST.check (c.to_string) string (valook.at (values.upper))
      b := values.at (values.upper - 1)
      //("b=" + b.to_string).println
      TEST.check (b.to_string) string (valook.at (values.upper - 1))
      a := values.at (values.upper - 2)
      //("a=" + a.to_string).println
      TEST.check (a.to_string) string (valook.at (values.upper - 2))
      op := operations.at i
      (op = '+').if {
        intz := c - b
        TEST.check (intz.to_string) string (a.to_string)
      }.elseif {op = '-'} then {
        intz := c + b
        TEST.check (intz.to_string) string (a.to_string)
      } else {
        TEST.check FALSE
      }
      values.remove_last
      valook.remove_last
    }
    TEST.check (values.upper = 1)
    TEST.check (valook.upper = 1)
  )
  
  - values_add z:ℤ <-
  (
    values.add_last z
    valook.add_last (z.to_string)
  )
  
